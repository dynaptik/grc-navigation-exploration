<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Compliance Journey Storyteller - GRC Portal</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; }
        
        /* Story animations */
        .story-card { 
            transition: all 0.3s ease;
            animation: storyUnfold 0.6s ease-out;
        }
        .story-card:hover { 
            transform: translateY(-4px); 
            box-shadow: 0 20px 40px rgba(0,0,0,0.1); 
        }
        
        /* Journey progress animations */
        .journey-step {
            transition: all 0.4s ease;
        }
        .journey-step.active {
            transform: scale(1.1);
            z-index: 10;
        }
        .journey-step.completed {
            animation: stepComplete 0.6s ease-out;
        }
        
        /* Story connection lines */
        .connection-line {
            background: linear-gradient(90deg, #3b82f6, #8b5cf6, #ec4899);
            height: 2px;
            animation: connectionFlow 3s ease-in-out infinite;
        }
        
        /* Chapter progress */
        .chapter-progress {
            background: linear-gradient(90deg, #10b981 0%, #10b981 var(--progress, 0%), #e5e7eb var(--progress, 0%));
            transition: background 1s ease-in-out;
        }
        
        /* Narrative text animations */
        .narrative-text {
            animation: typewriter 2s ease-out;
            border-right: 2px solid #3b82f6;
        }
        
        /* Interactive story elements */
        .story-choice {
            background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
            border: 1px solid #0ea5e9;
            transition: all 0.3s ease;
        }
        .story-choice:hover {
            background: linear-gradient(135deg, #0ea5e9 0%, #0284c7 100%);
            color: white;
            transform: translateX(4px);
        }
        
        /* Journey map styling */
        .journey-map {
            background: radial-gradient(circle at center, rgba(59, 130, 246, 0.1) 0%, transparent 70%);
        }
        
        /* Story insights panel */
        .insight-card {
            background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
            border-left: 4px solid #f59e0b;
        }
        
        @keyframes storyUnfold {
            from { opacity: 0; transform: rotateX(-90deg); }
            to { opacity: 1; transform: rotateX(0deg); }
        }
        
        @keyframes stepComplete {
            0% { transform: scale(1); }
            50% { transform: scale(1.2); background-color: #10b981; }
            100% { transform: scale(1); }
        }
        
        @keyframes connectionFlow {
            0% { opacity: 0.5; }
            50% { opacity: 1; }
            100% { opacity: 0.5; }
        }
        
        @keyframes typewriter {
            from { width: 0; }
            to { width: 100%; }
        }
        
        /* Progress ring animation */
        .progress-ring {
            transform: rotate(-90deg);
        }
        .progress-ring circle {
            transition: stroke-dashoffset 0.6s ease-in-out;
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <!-- Header -->
    <header class="bg-white border-b border-gray-200 sticky top-0 z-40 shadow-sm">
        <div class="container mx-auto px-6 py-4">
            <div class="flex justify-between items-center">
                <div>
                    <h1 class="text-2xl font-bold text-gray-900">Compliance Journey</h1>
                    <p class="text-sm text-gray-600">Navigate governance through interconnected stories</p>
                </div>
                <div class="flex items-center space-x-4">
                    <!-- Chapter Progress -->
                    <div class="flex items-center space-x-2 bg-purple-100 text-purple-800 px-3 py-2 rounded-lg">
                        <span class="text-sm">üìñ</span>
                        <span class="text-sm font-medium" id="chapter-indicator">Chapter Progress</span>
                        <span class="text-sm" id="chapter-progress">Beginning your journey...</span>
                    </div>
                    <!-- User Info -->
                    <div class="flex items-center space-x-2">
                        <div class="w-8 h-8 bg-gradient-to-br from-purple-500 to-pink-500 rounded-full flex items-center justify-center">
                            <span class="text-sm font-medium text-white">SC</span>
                        </div>
                        <span class="text-sm font-medium text-gray-700">Sarah Chen</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Hero Section -->
    <div class="bg-gradient-to-r from-blue-600 via-purple-600 to-purple-800 text-white py-16">
        <div class="container mx-auto px-6 text-center">
            <h2 class="text-4xl font-bold mb-4">Your Compliance Story Unfolds</h2>
            <p class="text-xl mb-8 max-w-4xl mx-auto">
                Every requirement tells a story, every assessment is a chapter, and every compliance 
                milestone is a victory. Let's explore your governance journey through narrative.
            </p>
            <div class="flex justify-center">
                <div class="bg-white bg-opacity-20 rounded-full px-8 py-2">
                    <div class="flex items-center space-x-4">
                        <div class="flex items-center space-x-2">
                            <div class="w-3 h-3 bg-green-400 rounded-full"></div>
                            <span class="text-sm">Current Chapter: Setting the Foundation</span>
                        </div>
                        <div class="w-px h-4 bg-white bg-opacity-30"></div>
                        <div class="text-sm" id="journey-progress">12% Complete</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <div class="container mx-auto px-6 py-8">
        <div class="grid lg:grid-cols-3 gap-8">
            <!-- Left Panel: Story Chapters -->
            <div class="lg:col-span-1">
                <div class="story-card bg-white rounded-xl shadow-lg p-6 mb-6">
                    <div class="flex items-center mb-4">
                        <span class="text-2xl mr-3">üìö</span>
                        <h3 class="text-lg font-semibold text-gray-900">Story Chapters</h3>
                    </div>
                    <div class="space-y-3" id="story-chapters">
                        <!-- Story chapters will be populated here -->
                    </div>
                </div>

                <!-- Story Context -->
                <div class="story-card bg-white rounded-xl shadow-lg p-6">
                    <div class="flex items-center mb-4">
                        <span class="text-2xl mr-3">üé≠</span>
                        <h3 class="text-lg font-semibold text-gray-900">Story Context</h3>
                    </div>
                    <div id="story-context">
                        <!-- Story context will be populated here -->
                    </div>
                </div>
            </div>

            <!-- Center Panel: Current Chapter -->
            <div class="lg:col-span-1">
                <div class="story-card bg-white rounded-xl shadow-lg p-6 mb-6">
                    <div class="flex items-center justify-between mb-4">
                        <h3 class="text-lg font-semibold text-gray-900" id="current-chapter-title">Beginning Your Journey</h3>
                        <div class="flex items-center text-sm text-gray-500">
                            <span>Progress</span>
                            <div class="ml-2 w-16 h-2 bg-gray-200 rounded-full">
                                <div class="h-full bg-blue-600 rounded-full transition-all duration-500" style="width: 0%" id="current-progress-bar"></div>
                            </div>
                        </div>
                    </div>
                    
                    <div id="chapter-content" class="space-y-4">
                        <!-- Chapter content will be populated here -->
                    </div>
                    
                    <div class="mt-6 space-y-2" id="story-choices">
                        <!-- Story choices will be populated here -->
                    </div>
                </div>

                <!-- Journey Map -->
                <div class="story-card bg-white rounded-xl shadow-lg p-6">
                    <div class="flex items-center mb-4">
                        <span class="text-2xl mr-3">üó∫Ô∏è</span>
                        <h3 class="text-lg font-semibold text-gray-900">Journey Map</h3>
                    </div>
                    <div class="journey-map p-4 rounded-lg">
                        <div id="journey-visualization" class="relative">
                            <!-- Journey visualization will be populated here -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- Right Panel: Connected Stories & Insights -->
            <div class="lg:col-span-1">
                <!-- Connected Stories -->
                <div class="story-card bg-white rounded-xl shadow-lg p-6 mb-6">
                    <div class="flex items-center mb-4">
                        <span class="text-2xl mr-3">üîó</span>
                        <h3 class="text-lg font-semibold text-gray-900">Connected Stories</h3>
                    </div>
                    <div id="connected-stories" class="space-y-3">
                        <!-- Connected stories will be populated here -->
                    </div>
                </div>

                <!-- Story Insights -->
                <div class="story-card bg-white rounded-xl shadow-lg p-6 mb-6">
                    <div class="flex items-center mb-4">
                        <span class="text-2xl mr-3">üí°</span>
                        <h3 class="text-lg font-semibold text-gray-900">Story Insights</h3>
                    </div>
                    <div id="story-insights" class="space-y-3">
                        <!-- Story insights will be populated here -->
                    </div>
                </div>

                <!-- Achievement Progress -->
                <div class="story-card bg-white rounded-xl shadow-lg p-6">
                    <div class="flex items-center mb-4">
                        <span class="text-2xl mr-3">üèÜ</span>
                        <h3 class="text-lg font-semibold text-gray-900">Achievements</h3>
                    </div>
                    <div id="achievements" class="space-y-3">
                        <!-- Achievements will be populated here -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Global state
        let currentChapter = 0;
        let chapterProgress = 0;
        let userChoices = [];
        let completedAchievements = [];

        // Story data structure
        const storyChapters = [
            {
                id: 'foundation',
                title: 'Setting the Foundation',
                description: 'Understanding your governance landscape',
                content: `Welcome to your compliance journey, Sarah! As a software architect, you're embarking on a quest to ensure your API systems meet all governance requirements.

Your story begins with the **Payment Gateway API** - a critical system that processes thousands of transactions daily. Like any epic tale, this journey has challenges, allies, and treasures to discover.

**The Challenge**: Your API must comply with security, performance, and data protection standards before the upcoming audit.`,
                choices: [
                    { text: 'Begin with Security Requirements', action: 'security-path' },
                    { text: 'Start with Performance Standards', action: 'performance-path' },
                    { text: 'Review All Requirements First', action: 'overview-path' }
                ],
                connections: ['security-quest', 'performance-saga'],
                insights: ['APIs are the backbone of modern applications', 'Security-first approach reduces technical debt'],
                progress: 0
            },
            {
                id: 'security-quest',
                title: 'The Security Quest',
                description: 'Protecting your digital fortress',
                content: `You've chosen the path of security - a wise decision! Your API fortress needs strong defenses against digital threats.

**Chapter 2: The Security Quest**

The OAuth Guardian appears before you, explaining the ancient art of authentication. "Three trials await," the Guardian declares:

1. **The Authentication Trial**: Implement OAuth 2.0
2. **The Encryption Challenge**: Secure data in transit and at rest  
3. **The Rate Limiting Test**: Protect against overwhelming forces

Each trial completed strengthens your API's defenses and brings you closer to compliance mastery.`,
                choices: [
                    { text: 'Accept the Authentication Trial', action: 'auth-trial' },
                    { text: 'Learn about Encryption Secrets', action: 'encryption-path' },
                    { text: 'Master Rate Limiting First', action: 'rate-limit-path' }
                ],
                connections: ['encryption-saga', 'performance-saga'],
                insights: ['OAuth 2.0 is the gold standard for API authentication', 'Security layers create defense in depth'],
                progress: 25
            },
            {
                id: 'performance-saga',
                title: 'The Performance Saga',
                description: 'Optimizing for speed and reliability',
                content: `The path of performance leads you to the Temple of Speed, where the Response Time Oracle awaits.

**Chapter 3: The Performance Saga**

"Speed without reliability is meaningless," the Oracle intones. "Reliability without monitoring is blind faith."

Your performance quest involves three sacred metrics:
- **Response Time**: Under 200ms for 95% of requests
- **Throughput**: Handle 1000 requests per second
- **Availability**: Maintain 99.9% uptime

The Oracle offers you three paths to achieve performance enlightenment.`,
                choices: [
                    { text: 'Optimize Response Times', action: 'response-optimization' },
                    { text: 'Scale for Throughput', action: 'throughput-scaling' },
                    { text: 'Build Monitoring Systems', action: 'monitoring-setup' }
                ],
                connections: ['monitoring-chronicle', 'quality-journey'],
                insights: ['Performance requirements should drive architecture decisions', 'Monitoring is essential for maintaining performance'],
                progress: 50
            },
            {
                id: 'compliance-victory',
                title: 'The Compliance Victory',
                description: 'Achieving governance mastery',
                content: `Congratulations, Sarah! You've reached the final chapter of your compliance journey.

**Chapter 4: The Compliance Victory**

Through your dedication to security, performance, and quality, your Payment Gateway API has achieved full compliance. The once-challenging requirements have become the foundation of a robust, secure, and high-performing system.

**Your Achievement Summary**:
- ‚úÖ All security requirements met
- ‚úÖ Performance benchmarks exceeded  
- ‚úÖ Quality standards implemented
- ‚úÖ Documentation completed

Your API is now ready for the audit, and more importantly, it's built to scale and evolve with your organization's needs.`,
                choices: [
                    { text: 'Start Next Project', action: 'new-journey' },
                    { text: 'Share Your Success Story', action: 'share-story' },
                    { text: 'Mentor Other Teams', action: 'mentor-mode' }
                ],
                connections: [],
                insights: ['Compliance is a journey, not a destination', 'Well-architected systems are inherently more compliant'],
                progress: 100
            }
        ];

        // Connected stories data
        const connectedStories = [
            {
                title: 'The Database Security Saga',
                description: 'How encryption requirements connect to your data layer',
                connection: 'security-quest',
                relevance: 'high'
            },
            {
                title: 'The Monitoring Chronicles',
                description: 'Performance insights that enhance security monitoring',
                connection: 'performance-saga',
                relevance: 'medium'
            },
            {
                title: 'The Audit Adventure',
                description: 'Preparing for the final compliance review',
                connection: 'compliance-victory',
                relevance: 'high'
            }
        ];

        // Initialize the storyteller
        document.addEventListener('DOMContentLoaded', function() {
            initializeStorytellerMode();
            renderCurrentChapter();
            populateStoryChapters();
            updateConnectedStories();
            updateStoryInsights();
            updateAchievements();
            startJourneyVisualization();
        });

        function initializeStorytellerMode() {
            currentChapter = 0;
            chapterProgress = 0;
            updateChapterIndicator();
        }

        function renderCurrentChapter() {
            const chapter = storyChapters[currentChapter];
            if (!chapter) return;

            // Update chapter title and content
            document.getElementById('current-chapter-title').textContent = chapter.title;
            document.getElementById('chapter-content').innerHTML = `
                <div class="narrative-text prose prose-sm text-gray-700">
                    ${chapter.content.split('\n\n').map(paragraph => `<p class="mb-4">${paragraph}</p>`).join('')}
                </div>
            `;

            // Update progress bar
            const progressBar = document.getElementById('current-progress-bar');
            setTimeout(() => {
                progressBar.style.width = chapter.progress + '%';
            }, 500);

            // Render story choices
            renderStoryChoices(chapter.choices);

            // Update journey progress
            document.getElementById('journey-progress').textContent = `${chapter.progress}% Complete`;
        }

        function renderStoryChoices(choices) {
            const container = document.getElementById('story-choices');
            container.innerHTML = choices.map((choice, index) => `
                <button onclick="makeStoryChoice('${choice.action}', ${index})" 
                        class="story-choice w-full text-left p-3 rounded-lg text-sm font-medium transition-all">
                    ${choice.text}
                </button>
            `).join('');
        }

        function populateStoryChapters() {
            const container = document.getElementById('story-chapters');
            container.innerHTML = storyChapters.map((chapter, index) => {
                const isCompleted = index < currentChapter;
                const isCurrent = index === currentChapter;
                const isLocked = index > currentChapter;

                return `
                    <div class="journey-step flex items-center p-3 rounded-lg cursor-pointer transition-all ${
                        isCurrent ? 'bg-blue-50 border-l-4 border-blue-500 active' : 
                        isCompleted ? 'bg-green-50 border-l-4 border-green-500 completed' : 
                        'bg-gray-50 border-l-4 border-gray-300'
                    }" onclick="${!isLocked ? `jumpToChapter(${index})` : ''}">
                        <div class="flex-shrink-0 mr-3">
                            ${isCompleted ? '‚úÖ' : isCurrent ? 'üìñ' : 'üîí'}
                        </div>
                        <div class="flex-1 min-w-0">
                            <h4 class="text-sm font-medium text-gray-900 truncate">${chapter.title}</h4>
                            <p class="text-xs text-gray-600 truncate">${chapter.description}</p>
                        </div>
                        <div class="flex-shrink-0 ml-2">
                            <div class="w-8 h-8">
                                <svg class="progress-ring" width="32" height="32">
                                    <circle cx="16" cy="16" r="14" stroke="#e5e7eb" stroke-width="2" fill="transparent"/>
                                    <circle cx="16" cy="16" r="14" stroke="${isCurrent ? '#3b82f6' : isCompleted ? '#10b981' : '#e5e7eb'}" 
                                            stroke-width="2" fill="transparent"
                                            stroke-dasharray="87.96" 
                                            stroke-dashoffset="${87.96 - (87.96 * (isCompleted ? 100 : isCurrent ? chapter.progress : 0) / 100)}"/>
                                </svg>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function updateStoryContext() {
            const chapter = storyChapters[currentChapter];
            const contextContainer = document.getElementById('story-context');
            
            contextContainer.innerHTML = `
                <div class="space-y-4">
                    <div class="p-4 bg-gradient-to-r from-blue-50 to-purple-50 rounded-lg">
                        <h4 class="font-medium text-gray-900 mb-2">Current Setting</h4>
                        <p class="text-sm text-gray-700">Payment Gateway API - Production Environment</p>
                    </div>
                    
                    <div class="p-4 bg-gradient-to-r from-green-50 to-blue-50 rounded-lg">
                        <h4 class="font-medium text-gray-900 mb-2">Your Role</h4>
                        <p class="text-sm text-gray-700">Software Architect leading compliance implementation</p>
                    </div>
                    
                    <div class="p-4 bg-gradient-to-r from-yellow-50 to-orange-50 rounded-lg">
                        <h4 class="font-medium text-gray-900 mb-2">Current Objective</h4>
                        <p class="text-sm text-gray-700">${chapter.description}</p>
                    </div>
                </div>
            `;
        }

        function updateConnectedStories() {
            const container = document.getElementById('connected-stories');
            const currentChapterId = storyChapters[currentChapter].id;
            
            const relevantStories = connectedStories.filter(story => 
                storyChapters[currentChapter].connections.includes(story.connection.split('-')[0] + '-quest') ||
                storyChapters[currentChapter].connections.includes(story.connection.split('-')[0] + '-saga')
            );

            container.innerHTML = relevantStories.map(story => `
                <div class="connected-story p-3 border border-gray-200 rounded-lg hover:border-blue-300 cursor-pointer transition-all"
                     onclick="exploreConnectedStory('${story.connection}')">
                    <div class="flex items-start justify-between mb-2">
                        <h4 class="text-sm font-medium text-gray-900">${story.title}</h4>
                        <span class="text-xs px-2 py-1 rounded-full ${
                            story.relevance === 'high' ? 'bg-red-100 text-red-700' : 
                            story.relevance === 'medium' ? 'bg-yellow-100 text-yellow-700' : 
                            'bg-green-100 text-green-700'
                        }">${story.relevance}</span>
                    </div>
                    <p class="text-xs text-gray-600">${story.description}</p>
                    <div class="connection-line mt-2 rounded-full"></div>
                </div>
            `).join('');

            if (relevantStories.length === 0) {
                container.innerHTML = '<p class="text-sm text-gray-500 text-center py-4">No connected stories at this point in your journey.</p>';
            }
        }

        function updateStoryInsights() {
            const chapter = storyChapters[currentChapter];
            const container = document.getElementById('story-insights');
            
            container.innerHTML = chapter.insights.map(insight => `
                <div class="insight-card p-3 rounded-lg">
                    <div class="flex items-start">
                        <span class="text-lg mr-2">üí°</span>
                        <p class="text-sm text-gray-800">${insight}</p>
                    </div>
                </div>
            `).join('');
        }

        function updateAchievements() {
            const container = document.getElementById('achievements');
            const achievements = [
                { title: 'Story Beginner', description: 'Started your compliance journey', unlocked: currentChapter >= 0 },
                { title: 'Security Champion', description: 'Completed security requirements', unlocked: currentChapter >= 1 },
                { title: 'Performance Master', description: 'Achieved performance goals', unlocked: currentChapter >= 2 },
                { title: 'Compliance Hero', description: 'Reached full compliance', unlocked: currentChapter >= 3 }
            ];

            container.innerHTML = achievements.map(achievement => `
                <div class="flex items-center p-3 rounded-lg ${achievement.unlocked ? 'bg-green-50' : 'bg-gray-50'}">
                    <span class="text-2xl mr-3">${achievement.unlocked ? 'üèÜ' : 'üîí'}</span>
                    <div>
                        <h4 class="text-sm font-medium ${achievement.unlocked ? 'text-green-900' : 'text-gray-500'}">${achievement.title}</h4>
                        <p class="text-xs ${achievement.unlocked ? 'text-green-700' : 'text-gray-400'}">${achievement.description}</p>
                    </div>
                </div>
            `).join('');
        }

        function startJourneyVisualization() {
            const container = document.getElementById('journey-visualization');
            container.innerHTML = `
                <div class="space-y-4">
                    ${storyChapters.map((chapter, index) => {
                        const isCompleted = index < currentChapter;
                        const isCurrent = index === currentChapter;
                        
                        return `
                            <div class="journey-step flex items-center space-x-4 p-3 rounded-lg transition-all ${
                                isCurrent ? 'bg-blue-50 border-l-4 border-blue-500' :
                                isCompleted ? 'bg-green-50 border-l-4 border-green-500' :
                                'bg-gray-50 border-l-4 border-gray-300'
                            }">
                                <div class="w-10 h-10 rounded-full flex items-center justify-center border-2 flex-shrink-0 ${
                                    isCompleted ? 'bg-green-500 border-green-500 text-white' :
                                    isCurrent ? 'bg-blue-500 border-blue-500 text-white' :
                                    'bg-gray-200 border-gray-300 text-gray-500'
                                }">
                                    ${isCompleted ? '‚úì' : index + 1}
                                </div>
                                <div class="flex-1 min-w-0">
                                    <h4 class="text-sm font-medium ${
                                        isCurrent ? 'text-blue-900' :
                                        isCompleted ? 'text-green-900' :
                                        'text-gray-500'
                                    }">${chapter.title}</h4>
                                    <p class="text-xs ${
                                        isCurrent ? 'text-blue-700' :
                                        isCompleted ? 'text-green-700' :
                                        'text-gray-400'
                                    }">${chapter.description}</p>
                                </div>
                                <div class="flex-shrink-0">
                                    <div class="text-xs font-medium ${
                                        isCompleted ? 'text-green-600' :
                                        isCurrent ? 'text-blue-600' :
                                        'text-gray-400'
                                    }">${
                                        isCompleted ? '100%' :
                                        isCurrent ? chapter.progress + '%' :
                                        '0%'
                                    }</div>
                                </div>
                            </div>
                        `;
                    }).join('')}
                </div>
            `;
        }

        function makeStoryChoice(action, choiceIndex) {
            userChoices.push({ chapter: currentChapter, choice: action, index: choiceIndex });
            
            // Simulate story progression based on choice
            switch (action) {
                case 'security-path':
                    if (currentChapter === 0) {
                        currentChapter = 1;
                    }
                    break;
                case 'performance-path':
                    if (currentChapter === 0) {
                        currentChapter = 2;
                    }
                    break;
                case 'overview-path':
                    showNotification('Reviewing all requirements gives you a strategic advantage!');
                    setTimeout(() => {
                        currentChapter = 1;
                        progressStory();
                    }, 2000);
                    return;
                case 'auth-trial':
                case 'encryption-path':
                case 'rate-limit-path':
                    if (currentChapter === 1) {
                        currentChapter = 2;
                    }
                    break;
                case 'response-optimization':
                case 'throughput-scaling':
                case 'monitoring-setup':
                    if (currentChapter === 2) {
                        currentChapter = 3;
                    }
                    break;
                case 'new-journey':
                case 'share-story':
                case 'mentor-mode':
                    showNotification('Your compliance story continues in new adventures!');
                    return;
            }
            
            progressStory();
        }

        function progressStory() {
            if (currentChapter < storyChapters.length) {
                updateChapterIndicator();
                renderCurrentChapter();
                populateStoryChapters();
                updateStoryContext();
                updateConnectedStories();
                updateStoryInsights();
                updateAchievements();
                startJourneyVisualization();
                
                showNotification(`Chapter unlocked: ${storyChapters[currentChapter].title}`);
            }
        }

        function jumpToChapter(chapterIndex) {
            if (chapterIndex <= currentChapter) {
                const oldChapter = currentChapter;
                currentChapter = chapterIndex;
                progressStory();
                showNotification(`Revisiting: ${storyChapters[chapterIndex].title}`);
            }
        }

        function exploreConnectedStory(storyId) {
            showNotification(`Exploring connected story: ${storyId.replace('-', ' ')}`);
        }

        function updateChapterIndicator() {
            const chapter = storyChapters[currentChapter];
            document.getElementById('chapter-progress').textContent = chapter.title;
        }

        function showNotification(message) {
            const notification = document.createElement('div');
            notification.className = 'fixed bottom-4 right-4 bg-purple-600 text-white px-6 py-3 rounded-lg shadow-lg z-50 transform translate-x-full transition-transform';
            notification.textContent = message;
            document.body.appendChild(notification);
            
            setTimeout(() => notification.classList.remove('translate-x-full'), 10);
            setTimeout(() => {
                notification.classList.add('translate-x-full');
                setTimeout(() => notification.remove(), 300);
            }, 4000);
        }
    </script>
</body>
</html>
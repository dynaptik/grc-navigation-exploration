<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Conversational Governance Assistant - GRC Portal</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; }
        .chat-bubble { animation: slideInChat 0.3s ease-out; }
        .typing-indicator { animation: typing 1.5s infinite; }
        .conversation-flow { max-height: 600px; }
        .quick-action { transition: all 0.2s ease; }
        .quick-action:hover { transform: scale(1.05); }
        .voice-animation { animation: voicePulse 2s infinite; }
        .bot-avatar { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
        .user-avatar { background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); }
        
        @keyframes slideInChat {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        @keyframes typing {
            0%, 60% { opacity: 0.3; }
            30% { opacity: 1; }
        }
        
        @keyframes voicePulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        /* Custom scrollbar for chat */
        .chat-scroll::-webkit-scrollbar { width: 6px; }
        .chat-scroll::-webkit-scrollbar-track { background: transparent; }
        .chat-scroll::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 3px; }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <!-- Header -->
    <header class="bg-white border-b border-gray-200 sticky top-0 z-40 shadow-sm">
        <div class="container mx-auto px-6 py-4">
            <div class="flex justify-between items-center">
                <div>
                    <h1 class="text-2xl font-bold text-gray-900">Governance Assistant</h1>
                    <p class="text-sm text-gray-600">Your conversational guide to GRC compliance</p>
                </div>
                <div class="flex items-center space-x-4">
                    <!-- Voice Control Toggle -->
                    <button id="voice-toggle" class="flex items-center space-x-2 bg-purple-50 hover:bg-purple-100 px-3 py-2 rounded-lg transition-all">
                        <div class="w-2 h-2 bg-purple-500 rounded-full voice-animation"></div>
                        <span class="text-sm text-purple-700 font-medium">Voice Mode</span>
                    </button>
                    <!-- Role Switcher -->
                    <select id="role-selector" class="text-sm border border-gray-300 rounded px-3 py-2">
                        <option value="architect">Architect</option>
                        <option value="developer">Developer</option>
                        <option value="manager">Manager</option>
                    </select>
                    <!-- User Info -->
                    <div class="flex items-center space-x-2">
                        <div class="w-8 h-8 user-avatar rounded-full flex items-center justify-center">
                            <span class="text-sm font-medium text-white">SC</span>
                        </div>
                        <span class="text-sm font-medium text-gray-700">Sarah Chen</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <div class="container mx-auto px-6 py-8">
        <div class="grid lg:grid-cols-4 gap-8">
            <!-- Left Panel: Quick Actions -->
            <div class="lg:col-span-1">
                <div class="bg-white rounded-xl shadow-lg p-6">
                    <h3 class="text-lg font-semibold text-gray-900 mb-4">Quick Actions</h3>
                    
                    <div class="space-y-3" id="quick-actions">
                        <div class="quick-action p-3 border border-gray-200 rounded-lg cursor-pointer hover:border-blue-300 hover:bg-blue-50 transition-all" onclick="quickAction('find-requirements')">
                            <div class="flex items-center mb-2">
                                <span class="text-lg mr-2">üîç</span>
                                <span class="text-sm font-medium text-gray-800">Find Requirements</span>
                            </div>
                            <p class="text-xs text-gray-600">Search for specific requirements</p>
                        </div>
                        
                        <div class="quick-action p-3 border border-gray-200 rounded-lg cursor-pointer hover:border-blue-300 hover:bg-blue-50 transition-all" onclick="quickAction('start-assessment')">
                            <div class="flex items-center mb-2">
                                <span class="text-lg mr-2">üìã</span>
                                <span class="text-sm font-medium text-gray-800">Start Assessment</span>
                            </div>
                            <p class="text-xs text-gray-600">Begin compliance assessment</p>
                        </div>
                        
                        <div class="quick-action p-3 border border-gray-200 rounded-lg cursor-pointer hover:border-blue-300 hover:bg-blue-50 transition-all" onclick="quickAction('view-dashboard')">
                            <div class="flex items-center mb-2">
                                <span class="text-lg mr-2">üìä</span>
                                <span class="text-sm font-medium text-gray-800">View Dashboard</span>
                            </div>
                            <p class="text-xs text-gray-600">See compliance overview</p>
                        </div>
                        
                        <div class="quick-action p-3 border border-gray-200 rounded-lg cursor-pointer hover:border-blue-300 hover:bg-blue-50 transition-all" onclick="quickAction('switch-asset')">
                            <div class="flex items-center mb-2">
                                <span class="text-lg mr-2">üéØ</span>
                                <span class="text-sm font-medium text-gray-800">Switch Asset</span>
                            </div>
                            <p class="text-xs text-gray-600">Change current asset context</p>
                        </div>
                    </div>

                    <!-- Asset Context -->
                    <div class="mt-6">
                        <h4 class="text-md font-semibold text-gray-800 mb-3">Current Context</h4>
                        <div id="current-context" class="text-sm text-gray-600">
                            <div class="p-3 border border-gray-200 rounded-lg">
                                <div class="flex items-center mb-2">
                                    <span class="text-lg mr-2">üîå</span>
                                    <span class="font-medium text-gray-900">Payment API Gateway</span>
                                </div>
                                <div class="text-xs text-gray-600">
                                    API ‚Ä¢ Security<br>
                                    Compliance: 78%
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Conversation Shortcuts -->
                <div class="bg-white rounded-xl shadow-lg p-6 mt-6">
                    <h3 class="text-lg font-semibold text-gray-900 mb-4">Conversation Starters</h3>
                    <div class="space-y-2" id="conversation-starters">
                        <button class="w-full text-left text-xs text-gray-600 hover:text-blue-600 hover:bg-blue-50 p-2 rounded transition-all" onclick="sendMessage('What security requirements apply to my API?')">
                            "What security requirements apply to my API?"
                        </button>
                        <button class="w-full text-left text-xs text-gray-600 hover:text-blue-600 hover:bg-blue-50 p-2 rounded transition-all" onclick="sendMessage('How do I start a compliance assessment?')">
                            "How do I start a compliance assessment?"
                        </button>
                        <button class="w-full text-left text-xs text-gray-600 hover:text-blue-600 hover:bg-blue-50 p-2 rounded transition-all" onclick="sendMessage('Show me high-priority requirements')">
                            "Show me high-priority requirements"
                        </button>
                        <button class="w-full text-left text-xs text-gray-600 hover:text-blue-600 hover:bg-blue-50 p-2 rounded transition-all" onclick="sendMessage('What is my current compliance score?')">
                            "What's my current compliance score?"
                        </button>
                        <button class="w-full text-left text-xs text-gray-600 hover:text-blue-600 hover:bg-blue-50 p-2 rounded transition-all" onclick="sendMessage('Help me understand risk levels')">
                            "Help me understand risk levels"
                        </button>
                        <button class="w-full text-left text-xs text-gray-600 hover:text-blue-600 hover:bg-blue-50 p-2 rounded transition-all" onclick="sendMessage('Which assets need attention?')">
                            "Which assets need attention?"
                        </button>
                    </div>
                </div>
            </div>

            <!-- Center Panel: Chat Interface -->
            <div class="lg:col-span-2">
                <div class="bg-white rounded-xl shadow-lg h-full flex flex-col">
                    <!-- Chat Header -->
                    <div class="p-6 border-b border-gray-200">
                        <div class="flex items-center justify-between">
                            <div class="flex items-center space-x-3">
                                <div class="w-10 h-10 bot-avatar rounded-full flex items-center justify-center">
                                    <span class="text-white text-lg">ü§ñ</span>
                                </div>
                                <div>
                                    <h3 class="text-lg font-semibold text-gray-900">GRC Assistant</h3>
                                    <p class="text-sm text-green-600">‚óè Online and ready to help</p>
                                </div>
                            </div>
                            <button id="clear-chat" class="text-sm text-gray-500 hover:text-gray-700 px-3 py-1 rounded" onclick="clearChat()">
                                Clear Chat
                            </button>
                        </div>
                    </div>

                    <!-- Chat Messages -->
                    <div class="flex-1 p-6 overflow-y-auto chat-scroll conversation-flow" id="chat-messages">
                        <!-- Welcome message will be added here -->
                    </div>

                    <!-- Chat Input -->
                    <div class="p-6 border-t border-gray-200">
                        <div class="flex items-center space-x-3">
                            <div class="flex-1 relative">
                                <input 
                                    type="text" 
                                    id="chat-input" 
                                    placeholder="Ask me about requirements, assessments, or compliance..."
                                    class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 pr-12"
                                    maxlength="500"
                                    onkeypress="handleKeyPress(event)"
                                >
                                <div class="absolute right-3 top-1/2 transform -translate-y-1/2 text-xs text-gray-400">
                                    <span id="char-count">0</span>/500
                                </div>
                            </div>
                            <button 
                                id="send-button" 
                                class="px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 focus:ring-2 focus:ring-blue-500 transition-all font-medium"
                                onclick="sendMessageFromInput()"
                            >
                                Send
                            </button>
                        </div>
                        
                        <!-- Quick Reply Suggestions -->
                        <div class="mt-3 flex flex-wrap gap-2" id="quick-replies">
                            <!-- Quick replies will be populated here -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- Right Panel: Context & Insights -->
            <div class="lg:col-span-1">
                <!-- Current Task Progress -->
                <div class="bg-white rounded-xl shadow-lg p-6 mb-6">
                    <h3 class="text-lg font-semibold text-gray-900 mb-4">Current Task</h3>
                    <div id="current-task">
                        <div class="text-center py-8 text-gray-500">
                            <span class="text-2xl mb-2 block">üí¨</span>
                            <p class="text-sm">Start a conversation to see task progress</p>
                        </div>
                    </div>
                </div>

                <!-- Contextual Information -->
                <div class="bg-white rounded-xl shadow-lg p-6 mb-6">
                    <h3 class="text-lg font-semibold text-gray-900 mb-4">Smart Context</h3>
                    <div id="smart-context" class="space-y-3">
                        <div class="p-3 bg-gray-50 rounded-lg">
                            <h5 class="font-medium text-gray-900 mb-2">Current Focus</h5>
                            <p class="text-sm text-gray-700">Payment API Gateway security requirements</p>
                        </div>
                    </div>
                </div>

                <!-- Conversation Analytics -->
                <div class="bg-white rounded-xl shadow-lg p-6">
                    <h3 class="text-lg font-semibold text-gray-900 mb-4">Session Insights</h3>
                    <div id="conversation-analytics" class="space-y-3 text-sm">
                        <div class="flex justify-between">
                            <span class="text-gray-600">Messages:</span>
                            <span class="font-medium" id="message-count">0</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-gray-600">User queries:</span>
                            <span class="font-medium" id="user-count">0</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-gray-600">Bot responses:</span>
                            <span class="font-medium" id="bot-count">0</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-gray-600">Voice mode:</span>
                            <span class="font-medium" id="voice-status">Off</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Global state
        let conversationHistory = [];
        let currentUser = 'architect';
        let voiceMode = false;
        let currentTask = null;

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', function() {
            initializeConversation();
            updateCharacterCount();
        });

        function initializeConversation() {
            const welcomeMessage = {
                type: 'bot',
                content: `Hello Sarah! I'm your GRC Assistant. I can help you with:

‚Ä¢ Finding relevant requirements for your assets
‚Ä¢ Starting compliance assessments
‚Ä¢ Understanding risk implications
‚Ä¢ Navigating governance processes

What would you like to work on today?`,
                timestamp: new Date(),
                suggestions: ['Show security requirements', 'Start an assessment', 'Check compliance status']
            };

            addMessage(welcomeMessage);
            updateQuickReplies(welcomeMessage.suggestions);
        }

        function addMessage(message) {
            conversationHistory.push(message);
            renderMessages();
            scrollToBottom();
            updateAnalytics();
        }

        function renderMessages() {
            const container = document.getElementById('chat-messages');
            container.innerHTML = conversationHistory.map(message => {
                const isBot = message.type === 'bot';
                const avatarClass = isBot ? 'bot-avatar' : 'user-avatar';
                const alignClass = isBot ? 'items-start' : 'items-end';
                const bubbleClass = isBot ? 
                    'bg-gray-100 text-gray-800 rounded-br-lg rounded-t-lg' : 
                    'bg-blue-600 text-white rounded-bl-lg rounded-t-lg';

                return `
                    <div class="chat-bubble flex ${alignClass} mb-4">
                        ${isBot ? `
                            <div class="w-8 h-8 ${avatarClass} rounded-full flex items-center justify-center mr-3 flex-shrink-0">
                                <span class="text-white text-sm">ü§ñ</span>
                            </div>
                        ` : ''}
                        <div class="max-w-xs lg:max-w-md">
                            <div class="px-4 py-3 ${bubbleClass}">
                                <div class="text-sm whitespace-pre-line">${message.content}</div>
                            </div>
                            <div class="text-xs text-gray-500 mt-1 ${isBot ? 'text-left' : 'text-right'}">
                                ${formatTime(message.timestamp)}
                            </div>
                        </div>
                        ${!isBot ? `
                            <div class="w-8 h-8 ${avatarClass} rounded-full flex items-center justify-center ml-3 flex-shrink-0">
                                <span class="text-white text-sm">SC</span>
                            </div>
                        ` : ''}
                    </div>
                `;
            }).join('');
        }

        function sendMessage(content) {
            const userMessage = {
                type: 'user',
                content: content,
                timestamp: new Date()
            };
            
            addMessage(userMessage);
            
            // Clear input if message came from input field
            const chatInput = document.getElementById('chat-input');
            if (chatInput.value === content) {
                chatInput.value = '';
                updateCharacterCount();
            }

            // Show typing indicator
            showTypingIndicator();

            // Generate response after delay
            setTimeout(() => {
                hideTypingIndicator();
                const response = generateResponse(content);
                addMessage(response);
                updateQuickReplies(response.suggestions);
                updateContextInfo(response.context);
            }, 1000 + Math.random() * 2000);
        }

        function generateResponse(content) {
            const lowerContent = content.toLowerCase();
            
            if (lowerContent.includes('security') || lowerContent.includes('api')) {
                return {
                    type: 'bot',
                    content: `I found 3 security requirements relevant to your Payment API Gateway:

**SEC-001: API Authentication**
All API endpoints must implement OAuth 2.0 or equivalent authentication mechanisms.

**SEC-002: Data Encryption**
Sensitive data must be encrypted in transit using TLS 1.3 and at rest using AES-256.

**SEC-003: Rate Limiting**
APIs must implement rate limiting to prevent abuse and DDoS attacks.

Would you like me to help you start an assessment for these requirements?`,
                    timestamp: new Date(),
                    suggestions: ['Start security assessment', 'Show implementation guidance', 'View related requirements'],
                    context: { type: 'security', focus: 'API requirements' }
                };
            } else if (lowerContent.includes('assessment') || lowerContent.includes('evaluate')) {
                currentTask = {
                    id: 'assessment-start',
                    title: 'Security Assessment Setup',
                    steps: [
                        { title: 'Select Asset', completed: true },
                        { title: 'Choose Requirements', completed: false },
                        { title: 'Complete Questions', completed: false },
                        { title: 'Review Results', completed: false }
                    ]
                };
                updateCurrentTask();

                return {
                    type: 'bot',
                    content: `Great! I'll help you start a compliance assessment for **Payment API Gateway**.

I've identified the most relevant requirements based on your asset type (API) and domain (Security).

**Next Steps:**
1. ‚úÖ Asset selected: Payment API Gateway
2. üîÑ Choose specific requirements to assess
3. üìù Complete assessment questions
4. üìä Review compliance results

Which domain would you like to focus on first?`,
                    timestamp: new Date(),
                    suggestions: ['Security requirements', 'Performance requirements', 'Data requirements'],
                    context: { type: 'assessment', asset: 'Payment API Gateway' }
                };
            } else if (lowerContent.includes('score') || lowerContent.includes('compliance')) {
                return {
                    type: 'bot',
                    content: `Your current compliance status for **Payment API Gateway**:

üìä **Overall Score: 78%**

**Breakdown by Domain:**
‚Ä¢ Security: 85% (3 of 4 requirements met)
‚Ä¢ Performance: 75% (6 of 8 requirements met)  
‚Ä¢ Data Management: 70% (7 of 10 requirements met)

**Priority Actions:**
1. Complete data retention policy documentation
2. Implement automated performance monitoring
3. Update API documentation for new endpoints

Would you like me to help you address any of these gaps?`,
                    timestamp: new Date(),
                    suggestions: ['Focus on data management', 'Improve performance score', 'View detailed breakdown'],
                    context: { type: 'compliance', score: 78 }
                };
            } else if (lowerContent.includes('help') || lowerContent.includes('how')) {
                return {
                    type: 'bot',
                    content: `I'm here to help! Here's what I can assist you with:

**üîç Finding Information**
‚Ä¢ "Show security requirements for APIs"
‚Ä¢ "What compliance requirements apply to my app?"
‚Ä¢ "Explain risk levels"

**üìã Starting Assessments**  
‚Ä¢ "Start a compliance assessment"
‚Ä¢ "Begin security evaluation"
‚Ä¢ "Help me assess data requirements"

**üìä Getting Insights**
‚Ä¢ "What's my compliance score?"
‚Ä¢ "Show asset dashboard"
‚Ä¢ "Which requirements are most important?"

**‚öôÔ∏è Managing Context**
‚Ä¢ "Switch to [asset name]"
‚Ä¢ "Change my role to developer"
‚Ä¢ "Show my assigned assets"

Just ask me naturally - I understand conversational language!`,
                    timestamp: new Date(),
                    suggestions: ['Show my assets', 'Start assessment', 'Find requirements'],
                    context: { type: 'help' }
                };
            } else {
                return {
                    type: 'bot',
                    content: `I understand you're interested in "${content}". Let me help clarify what you need:

Are you looking to:
‚Ä¢ Find specific requirements or standards?
‚Ä¢ Start or continue a compliance assessment?  
‚Ä¢ Get information about your assets?
‚Ä¢ Understand governance processes?

You can also try these example questions:
‚Ä¢ "What security requirements apply to my API?"
‚Ä¢ "How do I start an assessment?"
‚Ä¢ "Show me my compliance dashboard"`,
                    timestamp: new Date(),
                    suggestions: ['Find requirements', 'Start assessment', 'Show assets', 'Help me understand'],
                    context: { type: 'clarification' }
                };
            }
        }

        function updateQuickReplies(suggestions) {
            if (!suggestions) return;
            
            const container = document.getElementById('quick-replies');
            container.innerHTML = suggestions.map(suggestion => `
                <button class="px-3 py-1 text-xs bg-gray-100 hover:bg-blue-100 hover:text-blue-700 rounded-full transition-all border border-gray-200"
                        onclick="sendMessage('${suggestion.replace(/'/g, "\\'")}')">
                    ${suggestion}
                </button>
            `).join('');
        }

        function updateContextInfo(context) {
            if (!context) return;
            
            const container = document.getElementById('smart-context');
            let contextHtml = '';

            switch (context.type) {
                case 'security':
                    contextHtml = `
                        <div class="p-3 bg-red-50 rounded-lg">
                            <h5 class="font-medium text-red-900 mb-2">Security Context</h5>
                            <p class="text-sm text-red-700">${context.focus || 'Security requirements identified'}</p>
                        </div>
                    `;
                    break;
                case 'assessment':
                    contextHtml = `
                        <div class="p-3 bg-blue-50 rounded-lg">
                            <h5 class="font-medium text-blue-900 mb-2">Assessment Context</h5>
                            <p class="text-sm text-blue-700">Setting up assessment for ${context.asset}</p>
                        </div>
                    `;
                    break;
                case 'compliance':
                    contextHtml = `
                        <div class="p-3 bg-green-50 rounded-lg">
                            <h5 class="font-medium text-green-900 mb-2">Compliance Context</h5>
                            <p class="text-sm text-green-700">Overall score: ${context.score}%</p>
                        </div>
                    `;
                    break;
            }

            container.innerHTML = contextHtml;
        }

        function updateCurrentTask() {
            if (!currentTask) return;
            
            const container = document.getElementById('current-task');
            container.innerHTML = `
                <div class="space-y-3">
                    <h4 class="font-medium text-gray-900">${currentTask.title}</h4>
                    <div class="space-y-2">
                        ${currentTask.steps.map(step => `
                            <div class="flex items-center text-sm">
                                <div class="w-4 h-4 rounded-full mr-2 flex items-center justify-center ${
                                    step.completed ? 'bg-green-100 text-green-600' : 'bg-gray-100 text-gray-400'
                                }">
                                    ${step.completed ? '‚úì' : '‚óã'}
                                </div>
                                <span class="${step.completed ? 'text-green-700' : 'text-gray-600'}">${step.title}</span>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
        }

        function quickAction(actionType) {
            let message = '';
            switch(actionType) {
                case 'find-requirements':
                    message = 'Show me requirements for my current asset';
                    break;
                case 'start-assessment':
                    message = 'Start a compliance assessment';
                    break;
                case 'view-dashboard':
                    message = 'Show my compliance dashboard';
                    break;
                case 'switch-asset':
                    message = 'Show me all my assets';
                    break;
            }
            if (message) {
                sendMessage(message);
            }
        }

        function sendMessageFromInput() {
            const input = document.getElementById('chat-input');
            const message = input.value.trim();
            if (message) {
                sendMessage(message);
            }
        }

        function handleKeyPress(event) {
            if (event.key === 'Enter') {
                sendMessageFromInput();
            }
        }

        function clearChat() {
            conversationHistory = [];
            currentTask = null;
            renderMessages();
            updateAnalytics();
            document.getElementById('current-task').innerHTML = `
                <div class="text-center py-8 text-gray-500">
                    <span class="text-2xl mb-2 block">üí¨</span>
                    <p class="text-sm">Start a conversation to see task progress</p>
                </div>
            `;
            document.getElementById('smart-context').innerHTML = `
                <div class="p-3 bg-gray-50 rounded-lg">
                    <h5 class="font-medium text-gray-900 mb-2">Current Focus</h5>
                    <p class="text-sm text-gray-700">Payment API Gateway security requirements</p>
                </div>
            `;
            initializeConversation();
        }

        function toggleVoiceMode() {
            voiceMode = !voiceMode;
            const button = document.getElementById('voice-toggle');
            const status = document.getElementById('voice-status');
            
            if (voiceMode) {
                button.className = button.className.replace('bg-purple-50', 'bg-purple-100');
                status.textContent = 'On';
                showNotification('Voice mode activated', 'info');
            } else {
                button.className = button.className.replace('bg-purple-100', 'bg-purple-50');
                status.textContent = 'Off';
                showNotification('Voice mode deactivated', 'info');
            }
        }

        function updateCharacterCount() {
            const input = document.getElementById('chat-input');
            const counter = document.getElementById('char-count');
            
            input.addEventListener('input', function() {
                counter.textContent = input.value.length;
            });
        }

        function updateAnalytics() {
            const messageCount = conversationHistory.length;
            const botMessages = conversationHistory.filter(m => m.type === 'bot').length;
            const userMessages = conversationHistory.filter(m => m.type === 'user').length;

            document.getElementById('message-count').textContent = messageCount;
            document.getElementById('user-count').textContent = userMessages;
            document.getElementById('bot-count').textContent = botMessages;
        }

        function showTypingIndicator() {
            const container = document.getElementById('chat-messages');
            const typingHtml = `
                <div id="typing-indicator" class="flex items-start mb-4">
                    <div class="w-8 h-8 bot-avatar rounded-full flex items-center justify-center mr-3">
                        <span class="text-white text-sm">ü§ñ</span>
                    </div>
                    <div class="bg-gray-100 rounded-br-lg rounded-t-lg px-4 py-3">
                        <div class="flex space-x-1">
                            <div class="w-2 h-2 bg-gray-500 rounded-full typing-indicator"></div>
                            <div class="w-2 h-2 bg-gray-500 rounded-full typing-indicator" style="animation-delay: 0.2s"></div>
                            <div class="w-2 h-2 bg-gray-500 rounded-full typing-indicator" style="animation-delay: 0.4s"></div>
                        </div>
                    </div>
                </div>
            `;
            
            container.insertAdjacentHTML('beforeend', typingHtml);
            scrollToBottom();
        }

        function hideTypingIndicator() {
            const indicator = document.getElementById('typing-indicator');
            if (indicator) indicator.remove();
        }

        function scrollToBottom() {
            const container = document.getElementById('chat-messages');
            container.scrollTop = container.scrollHeight;
        }

        function formatTime(timestamp) {
            return timestamp.toLocaleTimeString('en-US', { 
                hour: '2-digit', 
                minute: '2-digit' 
            });
        }

        function showNotification(message, type) {
            // Simple notification - could be enhanced
            console.log(`${type.toUpperCase()}: ${message}`);
        }

        // Voice toggle event listener
        document.getElementById('voice-toggle').addEventListener('click', toggleVoiceMode);

        // Role selector event listener  
        document.getElementById('role-selector').addEventListener('change', function(e) {
            currentUser = e.target.value;
            showNotification(`Switched to ${currentUser} role`, 'success');
        });
    </script>
</body>
</html>